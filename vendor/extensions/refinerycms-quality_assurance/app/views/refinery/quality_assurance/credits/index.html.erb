<% content_for :body do %>
  <div class="grid-container">
    <div class="grid-x grid-margin-x">
      <% if selected_company.present? %>
        <div class="cell" style="margin-bottom: 1rem;">
          <h3>Credits</h3>
          <% if (credits = @credits.active.group(:article_id).count).any? %>
            <% credits.each do |article_id, count| %>
              <div class="widget-item">
                <%=number_with_delimiter count, delimiter: ',' %> <span class="bold"><%= Refinery::Business::Article.find_by_id(article_id)&.name %></span> available
              </div>
            <% end %>

          <% else %>
            <p class="italic">You do not have any credits yet.</p>
          <% end %>
        </div>

        <div class="cell">
          <%= link_to 'Purchase Credits', refinery.new_business_purchase_path, class: 'button' %>
        </div>

      <% else %>
        <div class="cell">
          <p class="italic">No company selected</p>

          <p><%= link_to 'Select Company', refinery.business_companies_path, class: 'button' %></p>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<%= render 'refinery/content_page' %>
