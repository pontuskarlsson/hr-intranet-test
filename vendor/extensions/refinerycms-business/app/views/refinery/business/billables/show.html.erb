<% content_for :body do %>
  <h2><%= @billable.title %></h2>

  <section class="contact-card">
    <table class="cc-table">
      <tbody>
      <tr>
        <th style="width: 150px;">Title</th>
        <td><%= @billable.title %></td>
      </tr>
      <tr>
        <th>Description</th>
        <td><%= @billable.description %></td>
      </tr>
      <tr>
        <th>Company</th>
        <td><%= @billable.company.label %></td>
      </tr>
      <tr>
        <th>Project</th>
        <td>
          <% if page_role?(Refinery::Business::ROLE_INTERNAL_FINANCE) %>
            <%= form_for @billable, url: refinery.business_billable_path(@billable) do |f| %>
              <div class="input-group">
                <% if @billable.project.present? %>
                  <div class="input-group-button">
                    <%= link_to 'Go to', refinery.business_project_path(@billable.project), class: 'button' %>
                  </div>
                <% end %>
                <%= f.text_field :project_label, :class => 'js_project_field input-group-field' -%>
                <div class="input-group-button">
                  <%= f.submit 'Update', class: 'button' %>
                </div>
              </div>
            <% end %>
          <% else %>
            <%= @billable.project_code.presence || 'N/A' %>
          <% end %>
        </td>
      </tr>
      <tr>
        <th>Invoice</th>
        <td>
          <% if page_role?(Refinery::Business::ROLE_INTERNAL_FINANCE) %>
            <%= form_for @billable, url: refinery.business_billable_path(@billable) do |f| %>
              <div class="input-group">
                <% if @billable.invoice.present? %>
                  <div class="input-group-button">
                    <%= link_to 'Go to', refinery.business_invoice_path(@billable.invoice), class: 'button' %>
                  </div>
                <% end %>
                <%= f.text_field :invoice_label, :class => 'js_invoice_field input-group-field' -%>
                <div class="input-group-button">
                  <%= f.submit 'Update', class: 'button' %>
                </div>
              </div>
            <% end %>
          <% else %>
            <%= @billable.invoice_invoice_number.presence || 'N/A' %>
          <% end %>
        </td>
      </tr>
      <tr>
        <th>Status</th>
        <td><%= @billable.status %></td>
      </tr>
      </tbody>
    </table>
  </section>
<% end %>

<% content_for :javascripts do -%>
  <script>
    $(document).ready(function(){
      $('.js_invoice_field').autocomplete({
        source: <%= @billable.company.invoices.to_source %>
      });
      $('.js_project_field').autocomplete({
        source: <%= @billable.company.projects.to_source %>
      });
    });
  </script>
<% end -%>

<% content_for :stylesheets do -%>
  <%= stylesheet_link_tag '//ajax.googleapis.com/ajax/libs/jqueryui/1/themes/smoothness/jquery-ui.css' %>
<% end -%>

<%= render '/refinery/content_page' %>
