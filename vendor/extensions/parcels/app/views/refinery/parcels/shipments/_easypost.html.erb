
<% if shipment.from_address.missing_for_shipment.any? || shipment.to_address.missing_for_shipment.any? %>
  <p>There are missing elements in the addresses. <%= link_to 'Edit Addresses', refinery.edit_parcels_shipment_path(shipment) %></p>

<% else %>
  <%= form_for @easypost_shipper ||= ::Refinery::Parcels::EasypostShipper.new(shipment: shipment), url: refinery.easypost_ship_parcels_shipment_path(shipment) do |f| %>
    <% if shipment.bill_to == 'Sender' %>
      <%= render 'easypost_sender', f: f, shipment: shipment %>

    <% elsif shipment.bill_to == 'Receiver' %>
      <%= render 'easypost_receiver', f: f, shipment: shipment %>

    <% elsif shipment.bill_to == '3rd Party' %>
      <label>3rd Party Account (Be careful not to select the wrong account)
        <%= f.select :bill_to_account_id, options_from_collection_for_select(::Refinery::Parcels::ShipmentAccount.all, :id, :account_and_description) %>
      </label>
    <% end %>
  <% end %>
<% end %>
