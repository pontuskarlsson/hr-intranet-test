<%= form_for @manual_shipper ||= ::Refinery::Parcels::ManualShipper.new(shipment: shipment), url: refinery.manual_ship_parcels_shipment_path(shipment) do |f| %>
  <div class="row">
    <div class="columns">
      <label>Courier <small class="js_courier_label" style="color: #f00;"></small>
        <%= f.text_field :courier, class: 'js_courier_field' %>
      </label>
    </div>
  </div>

  <div class="row">
    <div class="columns">
      <label>Tracking Number
        <%= f.text_field :tracking_number %>
      </label>
    </div>
  </div>

  <div class="row">
    <div class="columns">
      <p><%= f.submit 'Ship', class: 'button tiny' %></p>
    </div>
  </div>
<% end %>

<% content_for :stylesheets do %>
  <%= stylesheet_link_tag '//ajax.googleapis.com/ajax/libs/jqueryui/1/themes/smoothness/jquery-ui.css' %>
<% end %>

<% content_for :javascripts do %>

  <script type="text/javascript">
    $(function(){
      $('.js_courier_field').autocomplete({
        source: <%= Refinery::Parcels::Shipment::COURIERS.keys.to_json.html_safe %>,
        change: function(event, ui) {
          console.log({
            t: this,
            source: $(this).data('uiAutocomplete').options.source,
            value: $(this).prop('value')
          })



          if ($(this).data('uiAutocomplete').options.source.indexOf($(this).prop('value')) >= 0) {
            $('.js_courier_label').text('');
          } else {
            $('.js_courier_label').text('Courier not found');
          }
        }
      });
    });
  </script>
<% end %>
