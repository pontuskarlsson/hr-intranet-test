<div class='page_part' id='<%= new_part ? "page_part_new_#{part_index}" : part.to_param %>'>
  <%= text_field_tag "page[parts_attributes][#{part_index}][title]", part.title, class: "js-page-part-#{part_index}-title" %>
  <%= text_field_tag "page[parts_attributes][#{part_index}][slug]", part.slug, class: "js-page-part-#{part_index}-slug" %>
  <%= text_area_tag "page[parts_attributes][#{part_index}][body]", part.body, :rows => 20, :class => 'visual_editor widest' %>
  <%= hidden_field_tag "page[parts_attributes][#{part_index}][position]", part_index %>
</div>

<% content_for :javascripts do %>
  <script type="text/javascript">
    $(function() {
      var slugOptions = {
        separator: '_'
      };

      $('.js-page-part-<%=part_index %>-title').on('input propertychange', function() {
        var part_title = $(this).val();

        if(part_title.length > 0) {
          var part_slug = getSlug(part_title, slugOptions);
          $('.js-page-part-<%=part_index %>-slug').val(part_slug);
        }
      });
    });
  </script>
<% end %>
