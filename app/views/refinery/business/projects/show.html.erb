<% content_for :body do %>
  <% if page_role? Refinery::Business::ROLE_INTERNAL %>
    <%= render 'add_section_to_project', section: @section %>
  <% end %>

  <h3><%= @project.code %></h3>
  <section class="contact-card">

    <h3>Project Details</h3>
    <table class="cc-table">
      <tbody>
      <tr>
        <th>Code</th>
        <td><%= @project.code %></td>
      </tr>
      <tr>
        <th>Description</th>
        <td><%= @project.description %></td>
      </tr>
      <tr>
        <th>Company</th>
        <td>
          <% if @project.company.present? %>
            <%= link_to @project.company_label, refinery.business_company_path(@project.company) %>
          <% else %>
            <%= @project.company_label %>
          <% end %>
        </td>
      </tr>
      <tr>
        <th>Reference</th>
        <td><%= @project.company_reference %></td>
      </tr>
      <tr>
        <th>Timeline</th>
        <td><%= @project.start_date %> - <%= @project.end_date || 'Current' %></td>
      </tr>
      <tr>
        <th>Status</th>
        <td><%= @project.status %></td>
      </tr>
      </tbody>
    </table>

    <h3>Project Scope</h3>
    <% if @project.sections.any? %>
      <ul class="tabs" data-tabs id="project-section-tabs">
        <% @project.sections.each_with_index do |section, i| %>
          <% if i.zero? %>
            <li class="tabs-title is-active"><a href="#panel<%= i %>" aria-selected="true"><%= section.section_type %></a></li>
          <% else %>
            <li class="tabs-title"><a data-tabs-target="panel<%= i %>" href="#panel<%= i %>"><%= section.section_type %></a></li>
          <% end %>
        <% end %>
      </ul>

      <div class="tabs-content" data-tabs-content="project-section-tabs">
        <% @project.sections.each_with_index do |section, i| %>
          <% if i.zero? %>
            <div class="tabs-panel is-active" id="panel<%= i %>">
              <%= render "section_#{section.section_type.downcase}", section: section %>
            </div>
          <% else %>
            <div class="tabs-panel" id="panel<%= i %>">
              <%= render "section_#{section.section_type.downcase}", section: section %>
            </div>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <p>No sections added.</p>
    <% end %>

  </section>
<% end %>

<%= render '/refinery/content_page' %>
