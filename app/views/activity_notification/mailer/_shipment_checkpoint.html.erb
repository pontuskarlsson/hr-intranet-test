<td class="route-container">
  <table class="route">
    <tbody>
    <tr>
      <td style="width: 1rem;" class="checkpoint">
        <div style="position: relative;">
          <div style="position: absolute;">
            <% if route.persisted? %>
              <% if route.has_completed? %>
                <%= asset_image_tag 'fa/fa_check_circle.png', class: 'fa departed' %>
              <% else %>
                <%= asset_image_tag 'fa/fa_circle_o.png', class: 'fa' %>
              <% end %>
            <% else %>
              <%= asset_image_tag 'fa/fa_question.png', class: 'fa' %>
            <% end %>
            A
          </div>
        </div>
      </td>

      <% if next_route.has_completed? %>
        <td class="transport arrived">&nbsp;</td>
      <% elsif route.has_completed? %>
        <td class="transport departed">&nbsp;</td>
      <% else %>
        <td class="transport">&nbsp;</td>
      <% end %>

      <% if route.has_completed? && !next_route.has_completed? %>
        <td class="in-transit" style="width: 1rem;">
          <div style="position: relative;">
            <div style="position: absolute;">
              <% if (route.route_origin? && next_route.route_destination?) || (route.route_port_of_loading? && next_route.route_port_of_discharge?) %>
                <% if shipment.mode == 'Air' %>
                  <%= asset_image_tag 'fa/fa_plane.png', class: 'fa' %>
                <% elsif shipment.mode == 'Rail' %>
                  <%= asset_image_tag 'fa/fa_train.png', class: 'fa' %>
                <% elsif shipment.mode == 'Road' %>
                  <%= asset_image_tag 'fa/fa_truck.png', class: 'fa' %>
                <% elsif shipment.mode == 'Sea' %>
                  <%= asset_image_tag 'fa/fa_ship.png', class: 'fa' %>
                <% else %>
                  <%= asset_image_tag 'fa/fa_truck.png', class: 'fa' %>
                <% end %>
              <% else %>
                <%= asset_image_tag 'fa/fa_truck.png', class: 'fa' %>
              <% end %>
              B
            </div>
          </div>
        </td>

        <% if next_route.has_completed? %>
          <td class="transport arrived">&nbsp;</td>
        <% elsif route.has_completed? %>
          <td class="transport departed">&nbsp;</td>
        <% else %>
          <td class="transport">&nbsp;</td>
        <% end %>
      <% end %>
    </tr>
    </tbody>
  </table>
</td>
